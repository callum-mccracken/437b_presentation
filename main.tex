% !TEX program = lualatex
\documentclass[10pt, aspectratio=169]{beamer}

\usepackage{appendixnumberbeamer}
\usepackage[export]{adjustbox}
\usepackage{booktabs}
\usepackage[scale=2]{ccicons}
\usepackage{pgfplots}
\usepackage{xspace}
\usepackage[compat=1.1.0]{tikz-feynman}

\usetheme[progressbar=frametitle,
subsectionpage=progressbar,
block=fill]{metropolis}

% make progress bar for every slide rather than just sections
\makeatletter
\setlength{\metropolis@frametitle@padding}{1.8ex}% <- default 2.2 ex
\setbeamertemplate{frametitle}{%
    \nointerlineskip%
    \begin{beamercolorbox}[%
        wd=\paperwidth,%
        sep=0pt,%
        leftskip=\metropolis@frametitle@padding,%
        rightskip=\metropolis@frametitle@padding,%
        ]{frametitle}%
        \metropolis@frametitlestrut@start%
        \insertframetitle%
        \nolinebreak%
        \metropolis@frametitlestrut@end%
    \end{beamercolorbox}
    \usebeamertemplate*{progress bar in head/foot}
}
\setlength{\metropolis@progressinheadfoot@linewidth}{1pt}



\usepgfplotslibrary{dateplot}

\newcommand{\themename}{\textbf{\textsc{metropolis}}\xspace}

\title{\Huge \textnormal{Improving Background Estimation for Di-Higgs Searches with ATLAS}}
\subtitle{PHYS 437B Presentations\newline
13 January, 2020}
% \date{\today}
\date{}
\author{Callum McCracken\\
Supervisor: Maximilian Swiatlowski\\
Co-Supervisor: Eduardo Martin-Martinez\\
Collaborators: Todd Seiss, Mel Shochet}

%\titlegraphic{\hfill\includegraphics[height=1.5cm]{logo.pdf}}
\setbeamercolor{background canvas}{bg=white}

\begin{document}

\maketitle

%%%%%%%%%%%%%%%%%%%%% SLIDE 1
{\setbeamertemplate{frame footer}{Image sources:
  \href{https://public-archive.web.cern.ch/en/research/AccelComplex-en.html}{\alert{Accelerator Complex}}, 
  \href{https://atlas.cern/discover/detector}{\alert{ATLAS}}, 
  \href{https://en.wikipedia.org/wiki/Higgs_boson}{\alert{Standard Model}}}
\begin{frame}{Overview: Higgs Research}
  \begin{columns}[onlytextwidth]
    \begin{column}{0.4\textwidth}
      \centering
      \includegraphics[width=0.9\linewidth]{images/accelerator_complex.png}
      \includegraphics[width=0.9\linewidth]{images/ATLAS_full.png}
    \end{column}
    \begin{column}{0.6\textwidth}
      \includegraphics[width=0.9\linewidth]{images/Standard_Model_of_Elementary_Particles.png}
    \end{column}
​  \end{columns}
\end{frame}
}


%%%%%%%%%%%%%%%%%%%%% SLIDE 2
\begin{frame}{The Big Picture -- Measuring the Higgs Self-Coupling}
  Relevant section of the SM Lagrangian for Higgs potential:\\
  
  $$V(\phi) = -\mu^2 \phi^2 + \lambda \phi^4 + \ldots \text{ Taylor exp. at min } \to V_T(\phi) = -\frac{\mu^4}{4\lambda} + \frac{\sqrt{2}\mu^3}{\lambda} \phi - 4 \mu^2\phi^2 + 2\sqrt{2\lambda}\mu\phi^3 + \ldots$$
  
  Constant and $\phi$ terms: can eliminate with change of coordinates, $\phi^2$: mass term,\\
  $\phi^3$: self-interaction or \alert{self-coupling} term, not well constrained\\ (current best: $\kappa_\lambda = (2\sqrt{2\lambda}\mu)/(2\sqrt{2\lambda}\mu)_{\text{SM}}$, $\kappa_\lambda \in [-2.3, 10.3]$ at 95\% confidence)

  \input{standalone_feynman.tex}
  To find $\kappa_\lambda$ we need $HH$ events, and we can find them using jets!
\end{frame}


%%%%%%%%%%%%%%%%%%%%% SLIDE 3
{\setbeamertemplate{frame footer}{Image sources: \href{https://arxiv.org/abs/1709.04533}{\alert{branching ratios}}, \href{https://en.wikipedia.org/wiki/B-tagging}{b-tagging image adapted from \alert{here}}}
\begin{frame}{Jets and Pairing}
  \begin{columns}[onlytextwidth]
    \begin{column}{0.76\textwidth}
      \centering
      \includegraphics[width=0.35\linewidth]{images/branching_ratios.png}\\
      $H \to 60\%\space b\bar{b} \to 2 \times b \text{ hadrons } \to 2 \times b\text{-jets}$
      \begin{itemize}
        \item \alert{Jets} are collections of particles with appx. the same direction
        \item ATLAS can't directly detect $H$ or $b$. Instead, use \alert{$b$-jets}, which can be directly detected (using secondary vertices)
        \item $b$-jet detection is not a perfect process (hence 437A report), and neither is \alert{pairing} -- identifying which jets came from which $H$
      \end{itemize}
    \end{column}
    \begin{column}{0.25\textwidth}
      \includegraphics[width=\linewidth]{images/jets_and_pairing.png}
    \end{column}
​  \end{columns}
\end{frame}
}



%%%%%%%%%%%%%%%%%%%%% SLIDE 4
\begin{frame}{Welcome to the Mass Plane}
  \begin{itemize}
    \item \alert{Mass plane}: reconstructed $(m_{H_1}, m_{H_2})$ values, $m_{H_1}$ has higher transverse momentum
    \item We expect a peak around $(125, 125)$ (all masses in GeV)
    \item \alert{The Problem of Background Modelling}: how to estimate background around peak?
    \item Signal Region (SR): blinded to reduce study bias
    \item Control Region (CR): for calibrating background estimation models
    \item Validation Region (VR): for testing background models
  \end{itemize}
  \centering
  \includegraphics[width=0.45\linewidth]{images/regions.png} \hspace{1cm}
  \includegraphics[width=0.45\linewidth, trim = 0 0 0 1.5cm, clip]{images/fullmassplane_4tag_data.png}
\end{frame}

\begin{frame}{The 2$b$RW Solution}
  \begin{columns}[onlytextwidth]
    \begin{column}{0.6\textwidth}
      \begin{itemize}
        \item All jets are similar to a rough approximation
        \item \alert{2$b$ data}: uses 2 $b$-jets and 2 other jets
        \item Similar to 4$b$ data outside of SR, but no peak
        \item 2$b$RW: derive a scaling (``ReWeighting'') function outside of SR, apply inside
        \item Provides a good first background estimate
        \item Assumes RW function applies in SR, may be false
        \item \alert{This project}: is there a better approach?
      \end{itemize}
    \end{column}
    \begin{column}{0.4\textwidth}
      \includegraphics[width=\linewidth]{images/fullmassplane_2tag_data.png}\\
    \end{column}
​  \end{columns}
  \begin{alertblock}{Note}
    Don't forget 2$b$ data is physically different from 4$b$ and 2$b$RW are not \textbf{real} SR values.\\
    2$b$RW is thought to be correct within around $\pm 10\%$.
	\end{alertblock}
\end{frame}

%%%%%%%%%%%%%%%%%%%%% SLIDE 5
{\setbeamertemplate{frame footer}{Histogram image from Todd Seiss}
\begin{frame}{New Approach: Neural Network}
  \begin{columns}[onlytextwidth]
    \begin{column}{0.6\textwidth}
      \begin{itemize}
        \item Given enough data, neural networks can learn arbitrary functions
        \item Goal: reproduce 2$b$RW $\pm 10\%$ using only 4$b$ data
        \item Inputs: $(m_{H_1}, m_{H_2}, m_{HH})$, output: $P(m_{H_1}, m_{H_2})$
        \item Initial model: layers (10,50,50,50), 100 epochs
        \item Generally good-looking mass plane predictions,\\
              2$b$RW agreement is not great though
      \end{itemize}
    \end{column}
    \begin{column}{0.4\textwidth}
      \includegraphics[width=\linewidth]{images/todd_nn_massplane.png}\\
      \includegraphics[width=\linewidth]{images/todd_nn_hist.png}\\
    \end{column}
​  \end{columns}
\end{frame}
}
%%%%%%%%%%%%%%%%%%%%% SLIDE 6
\begin{frame}{Neural Network Optimization}
  What if we...
  \begin{itemize}
    \item Add more bins?
    \item Add other variables? (e.g. 7-masses, NTag)
    \item Smooth data (kde, polynomial, ...)?
    \item NTag Network
    \item Overall impression: hard to improve by tweaks, should try another model
  \end{itemize}
\end{frame}

%%%%%%%%%%%%%%%%%%%%% SLIDE 7
\begin{frame}{New Approach: Gaussian Processes}
  \begin{itemize}
    \item smooth estimator, built-in variance calculation
    \item relies on variogram
    \item variogram equation and parameters
    \item some ways of auto-calculating parameters, but can we do better?
    \item best auto-Gaussian
  \end{itemize}
\end{frame}

%%%%%%%%%%%%%%%%%%%%% SLIDE 8
\begin{frame}{Gaussian Processes Tweaks and Results}
  \begin{itemize}
    \item Tested a bunch of variograms, insert best images
    \item tweaked to make variance low and flat
    \item tried 3d GPs fit, but won't run
    \item bummer: despite variance being flat, can't get variance much lower than 100\% 
  \end{itemize}
\end{frame}

%%%%%%%%%%%%%%%%%%%%% SLIDE 9
\begin{frame}{Flow Models}
  aaaaaa
\end{frame}

%%%%%%%%%%%%%%%%%%%%% SLIDE 10
\begin{frame}{Comparison of Flows to NN and GPR}
  Insert a bunch of other figures
\end{frame}

%%%%%%%%%%%%%%%%%%%%% CLOSER
% set background image to be a massplane or something
{\setbeamercolor{palette primary}{fg=white, bg=mDarkTeal}
\setbeamertemplate{footline}[default]
\begin{frame}[standout, noframenumbering]
  Questions?\\
  Comments?\\
  Any other techniques we should try?
\end{frame}
}

\appendix

%%%%%%%%%%%%%%%%%%%%% BACKUP
\begin{frame}{Backup Slides}
  \centering
  \href{https://docs.google.com/presentation/d/1HImb0b95RuvVrA4HmL7cHfeurqykYyKxsTvzd4683Mw/edit?usp=sharing}{\alert{Link to Google Slides with more details}}
\end{frame}

\end{document}
